# Tickline 系统

时间线系统是一个针对游戏流程管理和控制的上级游戏引擎/编辑器。其本身被设计用于充当微观与宏观功能的连接件。亦被用于作为全局资源管理，避免一些更适合全局控制的行为被错误地于微观处实现。

## 概念

Tickline会涉及到一些概念，在这里需要事先阐述：

### 对象

对象是储存于全局中的实体特例，Tickline会提供名为 `锚` 的组件，用于确定和跟踪指定的实体。Tickline会在每一次更新前，定位实体。

### 事件

事件是可以被触发并与其他游戏逻辑并发执行的逻辑。一些事件不可以与其他事件同时执行，因此Tickline允许开发者描述可以同时执行的事件集合。并为事件集合指定优先级，在高优先级事件尚未执行完毕之前，低优先级事件将被暂停执行。

### 动作

对象可以拥有若干个动作。动作被开发者定义的`触发器`触发，动作逻辑亦可以触发事件，所有动作默认属于 ACTION 事件，一个动作在尚未完全执行前，不可重复开始。

### 全局变量

如题，即声明的，可被全局共享的变量。

---

## 实现

时间线系统的底层仍然集成在引擎内部，使用C++实现，但是其上层使用woolang实现，开发的远期目标包括实现可视化开发。

---

## 目的

游戏的底层规则使用ECS实现，上层逻辑则使用Tickline控制和实现。有利于实现功能分层，亦避免编写相对危险的C++模块拓展。

---

## 结构

每个受到Tickline控制的世界，都需要挂载有TicklineSystem，此系统负责按层执行事件（物体的动作属于ActionEvent管理），
遇到高优先级事件组在一帧内未能执行完成时，低优先级的事件组会被暂停执行同层级的事件会在一帧内执行。

对象是带有锚的组件/实体集合，对象的行为在编写脚本时，有封装成类似面向对象的API；对象的锚用于识别对象的类型，这意味着
相同锚类型的实体可以在一个世界中存在多份，亦可以在不同世界中都存在。底层的Timeline会被注册对应锚类型的相关信息，用于
执行Action层逻辑。

在设计上而言，Action层级的优先级应当是最低的，默认情况下，ActionEvent即属于此层级。

只允许使用Woolang编写Tickline的事件处理函数。